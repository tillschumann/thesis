% Einführungskapitel
%

\chapter{Introduction}

In 2014, the Neurorobotics team at the Blue Brain Project\cite{bbp} (BBP), project of the Ecole Federale Polytechnique Federale de Lausanne (EPFL), successfully produced a point-neuron model
of a mouse brain from data provided by the Allen Institute for Brain Science \cite{AllenInstitute}.
Using the neural network simulator NEST\cite{gewaltig2007nest}, the BBP Neurorobotics team was able to simulate a
scaled-down model of a mouse brain on a laptop computer, paving the way towards
 a mouse brain that can interact with an environment. In order to make full-scale implementation of
the mouse brain model possible, a large scale of resources with low latency requirements is needed. Only modern supercomputers can provide these resources.
The current functionality of NEST generates large neuronal networks on a supercomputer based on random distributions, not yet from big experimental data contained in brain atlases.
The purpose of this thesis is to develop the means to fully model a mouse brain from experimental data using NEST software on available supercomputing architectures.
\newpage

\section{Brain simulation}
Brain simulation is a interdisciplinary field that links the diverse fields 
neuroscience, physics, computational biology and computer science together.
With the fast development of computer systems and the growing availability of experimental data,
computational simulations get more important. The computational power, which is available
now and will be available in the next years, allows simulations of mammalian brains. Even a
simulation of the human brain seems to be doable in the upcoming years. Modelling nervous
systems helps us to understand the functionality of the human brain. It can help us to
understand different kinds of diseases like Alzheimer\textquotesingle s and can help to develop novel therapies.
Since the human brain is not accessible to direct experimental studies models of the brain are
essential to understand its functionality.

\section{Anatomy of the brain}
 
 The human brain is the main part of the central nervous system
 which consists of the spinal cord, sensory organs
 and all the nerves that connect these organs with the rest of the body.
 These organs are responsible for the control and communication within the body.
 The nervous system is the most complex system of the human body with respect to functionality.
 It contains billions of nerve and glia cells. 
 The nerve cells are connected via synapses to a complex network.
 Electrical pulses among neurons transmit information through this network.
 Glia cells help maintain the right concentration of chemical substances in the
 extracellular space around neurons and provide supporting structures for the
 growth of neurons and for their spatial arrangement. \cite{CN}
  \subsection{Macroscopic structure}
  \label{sec:Macroscopicstructure}
  The anatomy of the brain varies in cell density and functionality.
  The outer layer is called gray matter. The color is caused by the high density of nerve cells.
  Underneath the gray matter is the white matter, which 
 mainly consists of connection fibers of the nerve cells.
 The thalamus is located in the middle of the brain and functions as a relay station between the sensory system and the cortical system for cognitive and motor control.
  \begin{figure}[!htbp]
  %\subfigure[A cross-section of the human brain shows different densities of nerve cells \cite{CN}.]{
  %\includegraphics[scale=0.3]{pictures/Aufbau1.png}
  %\label{Aufbau1}
  %}
  \hfill
  \subfigure[A general map of the human brain assigns parts of the gray matter to fuctionalities \cite{CN}.]{
  \includegraphics[scale=0.5]{pictures/Aufbau2.png}
  \label{Aufbau2}
  }
  \hfill
  \subfigure[The vertical structure of the gray matter shows six layers \cite{CN}.]{
  \includegraphics[scale=0.5]{pictures/mikro_aufbau.png}
  \label{mikroaufbau}
  }
  \caption[Macroscopic structure of the human brain]{Macroscopic structure of the human brain.}
  \end{figure}
  
 Due to the high density of nerve cells, the gray matter is the main source of information processing of the brain.
 Functionalities of the grey matter can still be assigned to parts of the brain as shown in Figure \ref{Aufbau2}.
  However, the number of nerve cells (neurons), the number of connections (synapses) and the structure differs from person to person.
  On average the number of neurons and synapses in the human brain is around $8*10^{10}$ and $1*10^{15}$, respectively. 
  The connections of each neuron is dynamic and can change over time. \\
  Examining  vertical structure of the cortex,
  the gray matter can be partitioned in six layers as shown in figure \ref{mikroaufbau}.
  The cells in each layer have similar cell type, connections to other layers and connections to the thalamus and other parts. \cite{CN}
  %-forebrain(anterior part of the brain)
  %-neocortex(surface of the mammalian brain, gray)

  \subsection{Microscopic structure}
  The nerve cells are tiny structures that are connected to each other.
  In order to fully understand the brain, it is necessary to take a deeper look at the nerve cells.
  There are different cell types in a brain. They vary in structure and size.
  Pyramidal, spiny stellate and smooth stellate cells occur most often.
  
  Figure \ref{Corticalneurons} depicts a typical neuron.
  It contains the soma (the cell body) dendrites and axons.
  Electrical pulses are transported from the dendrites to the soma.
  In case of a spike, an electrical impulse is forwarded through the axon.
  These axons are connected via synapses to further dendrites.
  Electrical impulses are transmitted via either chemical reactors (chemical synapses)
  or electrical contacts (gap junctions) between the axons and dendrites.
  \newpage
  \begin{figure}[!ht]
    \centering
    \includegraphics[scale=0.65]{pictures/Complete_neuron_cell_diagram_en.eps}
    \caption[Microscopic structure of a neuron]{Microscopic structure of a neuron. \cite{neuronpic}}
    \label{Corticalneurons}
  \end{figure}
  
  There are excitatory and inhibitory neurons.
  The excitatory neurons excite connected neurons, 
  in contrast the inhibitory neurons inhibit connected neurons.
  Via electrical currents, the connected neurons influence the membrane potential of each neuron.
  For example, Figure \ref{membrane_potential} shows the membrane potential plotted over time.
  Chemical processes inside the neuron generate a spike if the membrane potential reaches a specific electrical level called the threshold.  
  As shown in Figure \ref{membrane_potential} spikes are peaks in the membrane potential. \cite{CN}
  
  %-cortical neurons
  %-different cells: pyramidal, spiny stellate, smooth stellate
  %-cortical layers
  %-synapses
  
  %-10e12 neurons in the human brain
  \begin{figure}[!htbp]
  \subfigure[Membrane potential of a neuron over the time.
  The peaks are called spikes.
  There are four spikes in the time span shown.
  The firing threshold of the cell is at about 58 mV \cite{CN}.]{
  \includegraphics[scale=0.36]{pictures/membrane_potential.png}
  \label{membrane_potential}
  }
  \hspace{0.5cm}
  \subfigure[The dot plot shows spikes of each neuron over time. On the vertical axis there are the neurons number.
  The histogram in the lower panel sums up all spikes for each time bin. \cite{CN}]{
  \includegraphics[scale=0.36]{pictures/spike_plot.png}
  \label{spikeplot}
  }
  \caption[Illustrations of measurement plots of a single neurons and neuron networks]{Illustrations of measurement plots of a single neurons and neuron networks.}
  \label{fig:spikemembrane}
  \end{figure}
  
  In order to analyze the membrane potential more objectively it is reduced to timings of the spikes.
  For multiple neurons the spike timings in a dot plot can be visualized as in Figure \ref{spikeplot}.
  One can get an overview of the activity in a whole neuronal network if the spike sums are
  plotted (summed up spikes for each time bin) in a histogram (bottom row of figure \ref{spikeplot}). \cite{CN}
   
\section{Virtual mouse}
The Blue Brain Project neurorobotics team built a model mouse brain and a model mouse body, integrating them both into a single simulation and providing a simplified but comprehensive model of how the body and the brain interact with each other. It gives the possibility to
replicate sensory input and motor output using the mouse models.
The goal is to build the tools and the infrastructure that will allow researchers to perform virtual experiments on mice and other virtual organisms.

The BBP scientists used biological data of the mouse brain collected by the Allen Brain Institute in Seattle and the Biomedical Informatics Research Network in San Diego. These data contain detailed information about the position of the mouse brain's 75 million neurons and the connections between different regions of the brain. They integrated this information with complementary data on the shapes, sizes and connectivity of specific types of neurons collected by the Blue Brain Project in Geneva. A simplified version of the virtual mouse brain (just 200,000 neurons) was then mapped to different parts of the mouse body, including the mouse's spinal cord, whiskers, eyes and skin. For instance, touching the mouse's whiskers activated the corresponding parts of the mouse sensory cortex.\cite{virtualmouse}
	
\section{Allen Brain Atlas}
\label{sec:allen}
The Allen Institute for Brain Science provides a high-resolution map of neural connections in the mouse brain.
   It contains several injection experiments (see Figure \ref{fig:atlas}). The provided datasets of the experiments 
   contains a 3D image of cell injection and a 3D image of its axonal projection labelled by viral
   tracers.
   
   \begin{figure}[ht!]
   	\begin{center}
        \subfigure[Injection sites - showing all available experiments]{%
            \label{fig:allInjections}
            \includegraphics[width=0.4\textwidth]{pictures/connectionBrowser_allinjections.png}
        }
        \hspace{1cm}
        \subfigure[Projection density of one experiment]{%
            \label{fig:oneProjection}
            \includegraphics[width=0.32\textwidth]{pictures/connectionBrowser_oneinjections.png}
       }
   	\end{center}
    	\caption[Illustration of the given experiments and the projection image of an example experiment]{%
         Illustration of the given experiments and the projection image of an example experiment.
   		 It gives an insight into the synaptic structure of the whole brain. The colors are
   		 inverted to enhance the visibility. \cite{jones2009allen}
     }%
   \label{fig:atlas}
   \end{figure}
   The images provide connection information between neurons all over the brain.
   The extracted connectivity information is used to build a long range connectivity inside
   the mouse brain model.
   \begin{figure}[ht!]
   	\begin{center}
        \subfigure[Illustration injection]{%
           \label{fig:allInjections}
           \includegraphics[width=0.15\textwidth]{pictures/cg_illustration_injection.eps}
        }
        \hspace{0.5cm}
        \subfigure[Illustration projection]{%
            \label{fig:oneProjection}
            \includegraphics[width=0.15\textwidth]{pictures/cg_illustration_projection.eps}
       }
       \hspace{0.5cm}
       \subfigure[Merge experiment]{%
            \label{fig:mergeExperiment}
            \includegraphics[width=0.15\textwidth]{pictures/cg_illustration_merge.eps}
        }
        \hspace{0.5cm}
        \subfigure[Specify pre-synaptic and post-synaptic neurons]{%
            \label{fig:SpecifyPrePost}
            \includegraphics[width=0.15\textwidth]{pictures/cg_illustration_neurons.eps}
       }
    \end{center}
    	\caption[Illustration of which neurons are selected inside the injection and the projection region]{%
        Illustration of which neurons are selected inside the injection and the projection region.
        Neurons inside the injected voxels are selected as pre-synaptic neurons.
        Neurons inside the projection voxels, substracted by the injected voxels,
        are selected as post-synaptic neurons.
     }%
   \label{fig:atlasvoxel}
   \end{figure}

\newpage
The 3D images contain discrete voxelized density values.
Most entries are zero. All entries, which are above a given threshold, are interpreted 
as injected and projected voxels.
Using a piecewise constant interpolation, the values are assigned to each neuron.
For one experiment pre-synaptic and possible post-synaptic neurons are specified (see Figure \ref{fig:atlasvoxel}).
A set of experiments is used to connect neurons located at the injections
to the neurons at the projections. Because multiple experiments have injected the same regions and therefore
same neurons, for each neuron the experiment  which has the lowest total injection
density (sum of all injection densities) is used.
Algorithm \ref{alg2} iterates over all experiments and determines its
total injection. Inside, it iterates over all injected voxels.
Connections are generated for each neuron inside the voxel,
if the total injection density of the experiment is smaller than 
all used experiments before for these voxel.
For each neuron (pre-synaptic) $10,000$ connections are generated to neurons (post-synaptic) in the experiment projection area.
	The post-synaptic neurons are randomly (taking each probability value into account) picked
	out of all possible neurons inside the projection area.
	The delay is determined from on the distance of the source and target neuron.
	Further parameters are determined using a linear function of a random variable.
   
   \begin{algorithm}
	\KwData{Injection experiments}
	\KwResult{Long range synapses}
	\For{each experiment}{
		identify the corresponding rAAV
		\For{each injected voxel}{
			\If{rAAV smaller than one used before}{
				\For{each neuron n in voxel}{
					Select all neurons in the projection area; \\
					Assign each of them the normalized intensity value $D_i$ of the voxel they are situated in \\
					Generate a random number P between 0 and 1; \\
					Pick randomly a neuron i; \\
					\If{$P < D_i$}{
						Create an efferent synapse from the selected neuron to neuron $i$; \\
						Assign synaptic parameters; \\
					}
					Repeat from step 4) until Nsy=10000 efferent synapses are assigned	;
				}
			}
		}
	}
\caption{Long range connectivity generation using Allen Atlas data. \cite{Csx}}
\label{alg2}
\end{algorithm}
   
   \newpage
\section{Blue Brain Project recipe}

The Blue Brain Project was able to reconstruct a microcircuit of part of somatosensory cortex of a juvenile rat \cite{markram2015reconstruction}.
Members of the Blue Brain Project presented a complementary algorithmic approach that reconstructs neuronal microcircuitry
across all layers using available sparse data and that leverages biological principles and
interdependencies between datasets to predict missing biological data \cite{markram2015reconstruction}. 
The algorithms with the available data form a recipe which is applied to the mouse
brain model to estimate the short range connectivity inside the mouse neocortex.
\begin{figure}[ht!]
\centering
\includegraphics[scale=0.9]{pictures/BBPconnectionPropasMatrix.eps}
\caption[Synapses per connection and Connection probabilities from Blue Brain Project recipe]{(Left) Synapses per connection. A matrix of the average synapses per connection for multi-synapse connections formed between the 55 m-types.
(Right) Connection probabilities.
A matrix of average connection probabilities within 100 mm. \cite{markram2015reconstruction}}
\label{BBPconnectionPropasMatrix}
\end{figure}
The recipe is mainly based on connection probabilities of different neuron types inside the somatosenory cortex.
To a given point neuron cloud with neuron type information the recipe returns synaptic
connection details (e.g matrices in Figure \ref{BBPconnectionPropasMatrix} shows the number of connections and connection probability between two neurons concerning their \emph{m-type}), which are used to extent the mouse brain model with short range connectivity. 
\begin{figure}[ht!]
   	\begin{center}
        \subfigure[3D visualization of a reconstructed mouse
isocortical column that has a similar neuron density as the original Blue Brain Project column. \cite{Csx}]{%
            \label{fig:shortColumn}
            \includegraphics[width=0.22\textwidth]{pictures/g3111.png}
        }
        \hspace{0.5cm}
        \subfigure[3D visualization of the reconstructed mouse
isocortical column inside a point neuron model of the mouse brain. \cite{Csx}]{%
            \label{fig:shortColumnInCircuit}
            \includegraphics[width=0.34\textwidth]{pictures/column_in_brain_4_edit.png}
       } 
    	   \end{center}
    	\caption[Illustration of the reconstructed mouse isocortical column applied to a point neuron cloud]{ Illustration of the reconstructed mouse isocortical column applied to a point neuron cloud.
    	Layers 1, 2/3, 4, 5 and 6 are shown in different colors.
     }%
   %\label{fig:atlas}
   \label{fig:shortColumnInCircuit}
\end{figure}
The given generation script (see Algorithm \ref{alg:BBP}) loads needed neuron parameters (layer, m-type,
It iterates over all neurons inside the neocortex region
(neurons which are in layer 1 to 6 specified with the parameter layer).
For each neuron (pre-synaptic) all neurons (post-synaptic) inside its surrounded column
(see geometrical illustration in Figures \ref{fig:shortColumnInCircuit} and voxelized 2D illustration in
Figure \ref{illcolumn}) are selected.
\begin{figure}[ht!]
\centering
\includegraphics[scale=2.5]{pictures/illustration_shortrange_select.eps}
\caption[Illustration of column neuron selection for a pre-synaptic neuron]{Illustration of column neuron selection (green/border) for a pre-synaptic neuron (blue).
The neurons are stored in lists per voxel to simply the search by position.
The grid represents the voxels. The dotted line represents the search region.
The search algorithm iterates over all neurons inside the blue region.
The dashed line represents the column.}
\label{illcolumn}
\end{figure}
A random number $P$ is generated and a neuron is picked randomly from the selection.
The neurons acceptance value $D_i$ is determined from the given BBP matrices.
If it is below $P$ a connection between the two neurons is created.
All synaptic parameters are determined from the BBP matrices. 
   \begin{algorithm}[ht!]
	\KwData{BBP matrices}
	\KwResult{Short range synapses}
	\For{each neuron n}{
		Select all neurons in neuron $i$ column area; \\
		Generate a random number P between 0 and 1; \\
		Pick randomly a neuron j from selected area; \\
		Determine $D_i$ based on BBP matrices (neuron i properties, neuron j properties); \\
		\If{$P < D_i$}{
			Create an efferent synapse from neuron $i$ to neuron $j$; \\
			Assign synaptic parameters; \\
		}
	}
\caption{Short range connection generation using Blue Brain Project recipe. \cite{Csx}}
\label{alg:BBP}
\end{algorithm}

\section{Neural Simulation Tool}
\label{NEST}
The neural simulation tool NEST is a simulator for spiking neural network models that focuses on the dynamics, size and structure of neural systems rather than on the exact morphology of individual neurons. The development of NEST is coordinated by the NEST Initiative. NEST is used to model networks with simplified morphologies of spiking neurons of any size. For example it is used with
models of information processing e.g. in the visual or auditory cortex of mammals, models of network activity dynamics, e.g. laminar cortical networks or balanced random networks and models of learning and plasticity. A NEST simulation tries to follow the logic of an electrophysiological experiment that takes place inside a 
computer in which the neural system to be investigated must be defined by the experimenter. 
The definition is based on a number of neurons with parameters and connections between these neurons. NEST supports the generation based on probabilistic values. The stochastic settings of a neuronal network can be used to create its artificial copy inside of NEST. To manipulate or observe the network dynamics, the experimenter can define devices which represent the various instruments (for measuring and stimulation) found in real experiments. These devices write their data either to memory or to file. \cite{gewaltig2007nest}

NEST features the execution on parallel environments (e.g. JUQUEEN).
Therefore, it uses the MPI (Message Passing Interface \cite{snir1998mpi}) standard for interprocess communication.
For thread parallelism it supports both PThreads\cite{nichols1996pthread} and OpenMP\cite{dagum1998openmp}. \cite{gewaltig2007nest}


\newpage
\subsection{Data structure}
\label{sec:NEST:Datastructure}
NEST keeps the full neuronal network model in memory
and distinguishes between nodes and connections.
Nodes and connections represent neurons and synapses, respectively.
Nodes hold model parameters.
However, synapses store model parameters, and the pre-synaptic and post-synaptic neuron information, which each synapse connects.

In multi process environments neurons are distributed on ranks.
For multi threaded environments each thread processes a subset of neurons.
Each rank holds a list of meta information of all neurons.
The model objects are only stored on one rank.
Node $i$ is stored on rank $r_i$ (\ref{eq:processfromid}) and is processed by thread $t_i$ (\ref{eq:threadfromid}).
\begin{equation}
 	r_i = i \bmod N_{ranks}
 	\label{eq:processfromid}
\end{equation}
\begin{equation}
 	t_i = \frac{i}{N_{ranks}} \bmod N_{threads}
 	\label{eq:threadfromid}
\end{equation}
$N_{ranks}$ and $N_{threads}$ corresponds to the number of ranks and number of threads, respectively.
\begin{figure}[ht!]
\centering
\includegraphics[scale=0.4]{pictures/NESTonCluster.eps}
\caption[Illustration how NEST distributes nodes on ranks based on their id]{Illustration how NEST distributes nodes on ranks based on their id.
The squares represent the MPI ranks.
The circles represent the neurons and their locality.
The arrows represent synapses between the neurons.}
\label{fig:NeuronsOnNodes}
\end{figure}

Figure \ref{fig:NeuronsOnNodes} illustrates the distribution of node model objects on
the different ranks.
Synapses are stored on the thread (or rank for environments without thread parallelisms) where the post-synaptic node is placed.
Each thread holds a sparse table (see Figure \ref{fig:NESTsynstorage}) containing all
local synapses.
\begin{figure}[ht!]
\centering
\includegraphics[scale=0.9]{pictures/NEST_syn_storage.eps}
\caption[NEST sparse synapse table]{A sparse table
(dark orange structure and attached light orange boxes with arrows) holds the
thread-local connection objects (pink squares) sorted according to the global
index of the associated pre-synaptic node. The sparse table consists of $n_{gr}$
equally-sized groups, where each group maintains a bit field (tiny squares)
with one bit for each global node index in the group indicating the presence
or absence of local targets. If a particular node has local targets, the sparse
table stores a pointer to an additional inner data structure (light orange)
Auto-adjusting connection infrastructure of NEST.
Case 1: A particular node has less than $K_{cutoff}$
local connections and all are of the same type. A lightweight inner structure
(HomConnector) stores the connection objects in a fixed-size array.
A particular node has at least $K_{cutoff}$
local connections and all are of the same type. A HomConnector stores the
connection objects in a dynamically-sized vector (copied and simplified from \cite{kunkel2014spiking}).
}
\label{fig:NESTsynstorage}
\end{figure}

%\newpage
%\section{Visualization}
%To interpret the output of a neuronal simulation the spiking activity of the neurons is %analyzed. 
%Different types of methods allow to extract stochastic characteristics from spike trains.
%Besides this visualization of the spike trains taking their location into account,
%it can give an impression of the activity.

%\begin{itemize}
%      \item Visualization tools available
%      \item BBP
%      \item ViSNEST
%\end{itemize}

\section{Parallel IO}
Full-scale data-driven simulation require big input data. 
Therefore, efficient data processing and capabilities of the data format is important. 
To build a large scale neuronal network from point to point connectivity a large bandwidth to acess the data from disks is needed.
For a simulation of the mouse brain model $16$ TB of data (see Table \ref{table:circuits}) have to be loaded from disk.
Imprecise parallel IO access can lower the resulting bandwidth.
Thus, the distribution of the parallel loading has to be carefully chosen. HDF5 allows parallel access to one file.
It uses MPI IO\cite{gropp1998mpi} to manage parallel read and write operations. Further, HDF5 is a self descriptive format and therefore easy to handle
and exchanged between different platforms. Previously reduced circuits are stored in HDF5 file format by the neurorobotics team, 
because of its easy to use Python interface. On a personal computer a light weight python implementation allows to load a given
circuit from HDF5 to NEST, using HDF5 Python interface in combination the NEST python interface. Therefore, selecting the same or similar data 
format is preferred to reduce the number of needed adaptations of scripts.

The Hierarchical Data Format (HDF) implements a model for managing and storing data. The model includes an abstract data model and an abstract storage model (the data format), and libraries to implement the abstract model and to map the storage model to different storage mechanisms. The HDF5 Library provides a programming interface  for an implementation of the abstract models.
The main entities of data models are datasets.
A dataset is a multidimensional (rectangular) array of data elements.
The data elements have to be from the same data format.
The data formats can be a native format as INT, DOUBLE, or a compound of data formats.
To map the storage model of a dataset to memory, hyperslab selections (see Figure \ref{fig:hdf5hyperslabs:hyper}) provide access to subsets of the multidimensional 
array. \cite{hdf2011hdf5}
\begin{figure}[ht!]
   	\begin{center}
        \subfigure[Hyperslab selection of HDF5 in a single dataset.
        Hyperslabs allow to only access specific entries in at dataset.]{%
            %\label{fig:shortColumn}
            \includegraphics[scale=0.8]{pictures/HDF5Hyperslab.eps}
            \label{fig:hdf5hyperslabs:hyper}
        }
        \hspace{0.5cm}
        \subfigure[Hyperslab selections are used to distribute loaded data on the ranks. \emph{N1}, \emph{N2} and \emph{N3} correspond to the nodes 1, 2 and 3, respectively.]{%
            %\label{fig:shortColumnInCircuit}
            \includegraphics[scale=0.8]{pictures/HDF5Parallel.eps}
            \label{fig:hdf5hyperslabs:parallel}
       }
  
    	   \end{center}
    	\caption{%
        Illustration of the hyperslab functionallity of HDF5 and how it can be used for data distribution.
     }%
   \label{fig:hdf5hyperslabs}
   \end{figure}
Parallel HDF5 is a configuration of the HDF5 library which lets you share open files across multiple parallel processes. It uses the MPI (Message Passing Interface) standard for interprocess communication. The parallel HDF5 library offers functionality to read and write from file collectively and independently.
Using hyperslab selections each rank can access separate parts of a dataset (see Figure \ref{fig:hdf5hyperslabs:parallel}).

\section{Available super computers}
\label{sec:supercomputers}
Within the master thesis the Blue Brain 4 and the JUQUEEN are available for usage.
Both super computers are IBM Blue Gene/Q systems.
The Blue Brain 4 system is a key scientific tool for the neuroscientific research done at EPFL within the Blue Brain project\cite{BlueBrain4}. 
JUQUEEN is an IBM Blue Gene/Q system which is installed and operated at JSC.
Blue Brain 4 has 4 and JUQUEEN has 28 racks.
Each rack contains 32 node boards with 32 compute nodes each. A node consists of a processor comprising 16 1.6 GHz 64 bit IBM PowerPC A2 cores.
In order to use this architecture efficiently a hybrid parallelization strategy is necessary in general (e.g. MPI/OpenMP or MPI/Pthreads), especially since the main memory is limited to 16 GB per node (or 256 MB per process/thread with 4 processes/threads per core). \cite{JUQUEEN}

\section{Task description}
The second chapter will expand on the implementation, which enables the simulation of a full mouse brain model with NEST.
The described algorithm in chapter 1 was developed to create mouse brain models at smaller scale.
A well tested model of $200,000$ neurons, which corresponds to $0.3\%$ of the full model, should be scaled up to $75,000,000$ neurons.
Using the given implementation to generate the full model is not feasible, because of a lack of efficiency of the given implementations.
Further, a sequential approach is not possible in current computer architectures.
Therefore, the sequential algorithms are parallelized and implemented in \emph{C++}.
%paralyzed or paralleled? 

The neuronal simulator does not support the loading of large scale data-driven models.
Therefore, the neuronal simulator is extended with a new import module.
Data formats are proposed, which provide all necessary requirements for storing
the generated circuit
and importing the data by the neuronal simulator.

The import module are integrated into \emph{NEST 2.6.0}, which was the official release at
the beginning of the thesis.

The work detailed in this thesis includes: Defining a data format, rewriting the generation programs and extending the neuronal simulator with an import module.
Further, debugging and testing of the generated model and its simulation faces new requirements.
%tackle new requirements? i donÕt get this
New model validation techniques had to be developed and are partly shown in the following chapters.
The work was done as part of the high performance computing team of the Blue Brain Project in close collaboration with Csaba Eroe and the visualization teams from the Blue Brain Project and the IT-Center Aachen.

